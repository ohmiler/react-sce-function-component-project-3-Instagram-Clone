(this["webpackJsonpinstagram-clone"]=this["webpackJsonpinstagram-clone"]||[]).push([[0],{59:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n.n(a),o=n(17),s=n.n(o),i=(n(59),n(20)),r=n(9),l=n(26),u={apiKey:"AIzaSyAwHZJhcjanBKzEZfbC3GZbK_Xtk-1sds0",authDomain:"instagram-clone-21074.firebaseapp.com",projectId:"instagram-clone-21074",storageBucket:"instagram-clone-21074.appspot.com",messagingSenderId:"550545454923",appId:"1:550545454923:web:5938a35d3545afd6b35ace",measurementId:"G-YQ01NYXQMX"},m=l.a.initializeApp(u),d=m.firestore(),p=m.auth(),j=m.storage(),b=(n.p,n(64),n(97)),g=(n(65),n(99)),f=n(22),O=n(4),h=f.a.form.withConfig({displayName:"CommentBox__Wrapper",componentId:"sc-1eolf3d-0"})(["display:flex;align-items:center;border-top:1px solid #cacaca;"]),x=f.a.input.withConfig({displayName:"CommentBox__InputComment",componentId:"sc-1eolf3d-1"})(["flex:1;padding:10px;border:none;"]),v=f.a.button.withConfig({displayName:"CommentBox__InputButton",componentId:"sc-1eolf3d-2"})(["flex:0;border:none;color:#6082a3;padding:10px;background-color:white;"]),_=f.a.h4.withConfig({displayName:"CommentBox__Propmt",componentId:"sc-1eolf3d-3"})(["text-align:center;padding:10px;border-top:1px solid #cacaca;"]),C=function(e){var t=e.user,n=e.postID,c=e.setNewComment,o=Object(a.useState)(""),s=Object(r.a)(o,2),i=s[0],u=s[1];return Object(O.jsx)(O.Fragment,{children:t?Object(O.jsxs)(h,{children:[Object(O.jsx)(x,{type:"text",placeholder:"Add comment here...",value:i,onChange:function(e){return u(e.target.value)}}),Object(O.jsx)(v,{onClick:function(e){var a={comment:i,username:t.displayName,timestamp:l.a.firestore.FieldValue.serverTimestamp()};e.preventDefault(),d.collection("posts").doc(n).collection("comments").add(a),c(a),u("")},children:"Submit"})]}):Object(O.jsx)(_,{children:"Login to comment"})})},y=f.a.p.withConfig({displayName:"Comments__MoreComment",componentId:"sc-1o5euve-0"})(["margin:0px 20px 10px;font-size:0.8em;color:grey;cursor:pointer;"]),N=function(e){var t=e.username,n=e.comment;return Object(O.jsxs)(S,{children:[Object(O.jsx)(w,{children:t}),Object(O.jsx)(I,{children:n})]})},S=f.a.div.withConfig({displayName:"Comments__StyledCommentContainer",componentId:"sc-1o5euve-1"})(["display:flex;align-items:center;margin:0px 20px 10px;"]),w=f.a.h5.withConfig({displayName:"Comments__StyledUsername",componentId:"sc-1o5euve-2"})([""]),I=f.a.p.withConfig({displayName:"Comments__StyledComment",componentId:"sc-1o5euve-3"})(["margin-left:10px;font-size:0.8em;"]),k=function(e){var t=e.postID,n=e.newComment,c=Object(a.useState)([]),o=Object(r.a)(c,2),s=o[0],l=o[1],u=Object(a.useState)(!0),m=Object(r.a)(u,2),p=m[0],j=m[1],b=Object(a.useState)([]),g=Object(r.a)(b,2),f=g[0],h=g[1],x=function(){var e;if(t){if(e=d.collection("posts").doc(t).collection("comments").orderBy("timestamp","desc"),0!==s.length){var n=f[f.length-1];e=e.startAfter(n).limit(10)}else e=e.limit(3);e.get().then((function(e){0===e.docs.length&&j(!1),l([].concat(Object(i.a)(s),Object(i.a)(e.docs.map((function(e){return e.data()}))))),h([].concat(Object(i.a)(f),Object(i.a)(e.docs)))}))}};return Object(a.useEffect)((function(){x()}),[t]),Object(a.useEffect)((function(){l((function(e){return[n].concat(Object(i.a)(e))}))}),[n]),Object(O.jsxs)("div",{children:[s.map((function(e,t){return Object(O.jsx)(N,{username:e.username,comment:e.comment},t)})),p?Object(O.jsx)(y,{onClick:x,children:"Load more comments..."}):null]})},L=function(e){var t=e.postID,n=e.user,c=e.username,o=e.caption,s=e.imageURL,i=Object(a.useState)({}),l=Object(r.a)(i,2),u=l[0],m=l[1];return Object(O.jsxs)("div",{className:"post",children:[Object(O.jsxs)("div",{className:"post__header",children:[Object(O.jsx)(g.a,{className:"post__avatar",alt:c,src:"/static/images/avatar/1.jpg"}),Object(O.jsx)("h4",{className:"post__username",children:c})]}),Object(O.jsx)("img",{className:"post__image",src:s,alt:c}),Object(O.jsxs)("h4",{className:"post__caption",children:[Object(O.jsx)("strong",{children:c})," ",o]}),Object(O.jsx)(k,{postID:t,newComment:u}),Object(O.jsx)(C,{user:n,postID:t,setNewComment:m})]})},B=n(96),M=n(94),U=(n(70),n(98)),E=function(e){var t=e.igLogo,n=e.openModal,c=e.setOpenModal,o=e.openModalLogin,s=e.setOpenModalLogin,i=e.setUser,l=Object(M.a)((function(e){return{paper:{position:"absolute",width:400,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},button:{marginTop:8}}}))(),u=Object(a.useState)((function(){return{top:"".concat(50,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(50,"%)")}})),m=Object(r.a)(u,1)[0],d=Object(a.useState)(""),j=Object(r.a)(d,2),g=j[0],f=j[1],h=Object(a.useState)(""),x=Object(r.a)(h,2),v=x[0],_=x[1],C=Object(a.useState)(""),y=Object(r.a)(C,2),N=y[0],S=y[1],w=function(){o?(p.signInWithEmailAndPassword(N,v).catch((function(e){return alert(e.message)})),s(!1)):(p.createUserWithEmailAndPassword(N,v).then((function(e){e.user.updateProfile({displayName:g})})).catch((function(e){return alert(e.message)})),c(!1))},I=function(e){"Enter"===e.key&&w()};return Object(O.jsx)(B.a,{open:n||o,onClose:function(){c(!1),s(!1)},children:Object(O.jsx)("div",{style:m,className:l.paper,children:Object(O.jsxs)("form",{className:"auth__form",children:[Object(O.jsx)("center",{children:Object(O.jsx)("img",{src:t,alt:"instagram logo"})}),Object(O.jsx)(U.a,{placeholder:"email",type:"email",onChange:function(e){return S(e.target.value)}}),o?null:Object(O.jsx)(U.a,{placeholder:"username",type:"text",onChange:function(e){return f(e.target.value)},onKeyPress:I}),Object(O.jsx)(U.a,{placeholder:"password",type:"password",onChange:function(e){return _(e.target.value)},onKeyPress:I}),Object(O.jsx)(b.a,{className:l.button,variant:"outlined",color:"primary",onClick:w,children:o?"Sign In":"Sign Up"}),o?Object(O.jsx)(b.a,{onClick:function(){var e="guest-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5);p.signInAnonymously().then((function(t){t.user.updateProfile({displayName:e}).then((function(e){return i(e)})),s(!1)}))},children:"Log in as Guest"}):null]})})})},P=(n(71),function(e){var t=e.setNewPost,n=p.currentUser.displayName,c=Object(a.useState)(null),o=Object(r.a)(c,2),s=o[0],i=o[1],u=Object(a.useState)(""),m=Object(r.a)(u,2),g=m[0],f=m[1],h=Object(a.useState)(0),x=Object(r.a)(h,2),v=x[0],_=x[1];return Object(O.jsxs)("div",{className:"postupload",children:[Object(O.jsx)("h1",{children:"Upload your image"}),Object(O.jsx)(U.a,{id:"fileinput",style:{marginTop:"30px"},className:"child",type:"file",name:"upload-file",onChange:function(e){e.target.files[0]&&i(e.target.files[0])}}),Object(O.jsx)("progress",{className:"child",max:100,value:v}),Object(O.jsx)(U.a,{className:"child",type:"text",name:"upload-caption",placeholder:"write your caption here",value:g,onChange:function(e){return f(e.target.value)}}),Object(O.jsx)(b.a,{variant:"contained",style:{backgroundColor:"#228B22",padding:"10px 15px",marginBottom:"30px",color:"white"},className:"child",onClick:function(){var e=s.name+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5);j.ref("images/".concat(e)).put(s).on("state_changed",(function(e){var t=Math.round(e.bytesTransferred/e.totalBytes*100);_(t)}),(function(e){console.log(e),alert(e.message)}),(function(){j.ref("images").child(e).getDownloadURL().then((function(e){!function(e,n,a){var c={timestamp:l.a.firestore.FieldValue.serverTimestamp(),caption:e,username:n,imageURL:a};d.collection("posts").add(c).then((function(e){t({post:c,id:e.id})})).catch((function(e){return console.error(e)}))}(g,n,e)})),_(0),i(null),f("")}))},children:"Upload"})]})}),A=n(95),D=function(){var e="https://www.instagram.com/static/images/web/mobile_nav_type_logo.png/735145cfe0a4.png",t=Object(a.useState)([]),n=Object(r.a)(t,2),c=n[0],o=n[1],s=Object(a.useState)([]),l=Object(r.a)(s,2),u=l[0],m=l[1],j=Object(a.useState)(!0),g=Object(r.a)(j,2),f=g[0],h=g[1],x=Object(a.useState)(null),v=Object(r.a)(x,2),_=v[0],C=v[1],y=Object(a.useState)({}),N=Object(r.a)(y,2),S=N[0],w=N[1],I=Object(a.useState)(!0),k=Object(r.a)(I,2),B=k[0],M=k[1],U=Object(a.useState)(!1),D=Object(r.a)(U,2),T=D[0],F=D[1],z=Object(a.useState)(!1),K=Object(r.a)(z,2),R=K[0],G=K[1];Object(a.useEffect)((function(){var e=p.onAuthStateChanged((function(e){C(e||null)}));return function(){e()}}),[_]);var H=function(){var e=d.collection("posts").orderBy("timestamp","desc");if(0!==u.length){var t=c[c.length-1];e=e.startAfter(t)}e.limit(10).get().then((function(e){0===e.docs.length&&M(!1),o([].concat(Object(i.a)(c),Object(i.a)(e.docs))),m([].concat(Object(i.a)(u),Object(i.a)(e.docs.map((function(e){return{id:e.id,post:e.data()}})))))})),setTimeout(h(!1),1e3)};Object(a.useEffect)((function(){H()}),[]),Object(a.useEffect)((function(){!1!==f&&H()}),[f]),Object(a.useEffect)((function(){0!==Object.keys(S).length&&m((function(e){return[S].concat(Object(i.a)(e))}))}),[S]);return console.log(u),Object(O.jsxs)("div",{className:"app",onScroll:function(e){e.target.scrollHeight-e.target.scrollTop===e.target.clientHeight&!1===f&!0===B&&h(!0)},children:[Object(O.jsx)(E,{igLogo:e,openModal:T,setOpenModal:F,openModalLogin:R,setOpenModalLogin:G,setUser:C}),Object(O.jsxs)("div",{className:"app__header",children:[Object(O.jsx)("img",{className:"app__headerImage",src:e,alt:"instagram logo"}),Object(O.jsx)("div",{children:_?Object(O.jsx)(b.a,{onClick:function(){p.signOut()},children:"Log Out"}):Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(b.a,{onClick:function(){return F(!0)},children:"SignUp"}),Object(O.jsx)(b.a,{onClick:function(){return G(!0)},children:"SignIn"})]})})]}),Object(O.jsxs)("div",{className:"contents",children:[_?Object(O.jsx)(P,{username:_.displayName,setNewPost:w}):Object(O.jsx)("h4",{className:"app__notify",children:Object(O.jsx)(b.a,{onClick:function(){return G(!0)},children:"Login to post"})}),Object(O.jsx)("div",{className:"app__post_view",children:Object(O.jsxs)("div",{className:"app__post_wrapper",children:[u.map((function(e){var t=e.id,n=e.post;return Object(O.jsx)(L,{postID:t,user:_,username:n.username,caption:n.caption,imageURL:n.imageURL},t)})),B?Object(O.jsx)("div",{className:"app__loading",children:Object(O.jsx)(A.a,{})}):Object(O.jsx)("h5",{className:"app__bottom",children:"No more post!"})]})})]})]})},T=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,101)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),o(e),s(e)}))};s.a.render(Object(O.jsx)(c.a.StrictMode,{children:Object(O.jsx)(D,{})}),document.getElementById("root")),T()}},[[72,1,2]]]);
//# sourceMappingURL=main.04aa5561.chunk.js.map